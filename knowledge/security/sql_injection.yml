# SQL Injection Detection Rules

patterns:
  - pattern: ".*\\+.*user.*\\+.*"
    description: "String concatenation with user input in SQL query"
    severity: "critical"
    suggestion: "Use parameterized queries or prepared statements"
  
  - pattern: "f\".*{.*user.*}.*\""
    description: "f-string with user input in SQL query"
    severity: "critical"
    suggestion: "Use parameterized queries or prepared statements"
  
  - pattern: "\\.format\\(.*user.*\\)"
    description: "format() with user input in SQL query"
    severity: "critical"
    suggestion: "Use parameterized queries or prepared statements"
  
  - pattern: "%.*user.*%"
    description: "String formatting with user input in SQL query"
    severity: "critical"
    suggestion: "Use parameterized queries or prepared statements"

safe_practices:
  - "Always use parameterized queries or prepared statements"
  - "Validate and sanitize all user inputs"
  - "Use ORM frameworks when possible"
  - "Implement least privilege principle for database access"
  - "Log and monitor failed query attempts"

examples:
  - bad: "SELECT * FROM users WHERE id = " + userId
  - good: "SELECT * FROM users WHERE id = ?"
  - bad: f"SELECT * FROM users WHERE name = '{name}'"
  - good: "SELECT * FROM users WHERE name = %s"
